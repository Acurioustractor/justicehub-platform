#!/usr/bin/env node
import { readFileSync } from 'fs';
import { join, dirname } from 'path';
import { fileURLToPath } from 'url';
import { createClient } from '@supabase/supabase-js';

const __dirname = dirname(fileURLToPath(import.meta.url));
const root = join(__dirname, '..');

const env = readFileSync(join(root, '.env.local'), 'utf8')
  .split('\n')
  .filter(line => line && line.trim() && line[0] !== '#' && line.includes('='))
  .reduce((acc, line) => {
    const [key, ...values] = line.split('=');
    acc[key.trim()] = values.join('=').trim();
    return acc;
  }, {});

const supabase = createClient(
  env.NEXT_PUBLIC_SUPABASE_URL,
  env.SUPABASE_SERVICE_ROLE_KEY
);

console.log('\nüåè ADDING MORE STATE PROGRAMS TO REACH 30+ COVERAGE\n');

// MORE NSW PROGRAMS (need 12+ more to reach 30)
const moreNSW = [
  {
    name: 'Youth off the Streets',
    type: 'Wraparound Support',
    description: 'Comprehensive youth support services across Sydney including crisis accommodation, education programs, employment pathways, and family support. Long-established NGO supporting at-risk young people.',
    target_cohort: ['12-25 years', 'Homeless youth', 'At-risk youth'],
    geography: ['NSW', 'Sydney', 'Inner West Sydney'],
    evidence_level: 'Effective (strong evaluation, positive outcomes)',
    cultural_authority: 'Youth off the Streets - NGO',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.youthoffthestreets.com.au/',
    operating_organization: 'Youth off the Streets',
    metadata: {
      source: 'Youth off the Streets website',
      established: '1991',
      programs: ['Crisis accommodation', 'Education programs', 'Employment pathways', 'Family support'],
    },
  },
  {
    name: 'The Shopfront Youth Legal Centre',
    type: 'Diversion',
    description: 'Free legal service for homeless and disadvantaged young people in Sydney. Youth-focused legal advice, court support, and advocacy. Specialist youth homelessness and criminal law practice.',
    target_cohort: ['12-25 years', 'Homeless youth', 'Sydney'],
    geography: ['NSW', 'Sydney', 'Inner Sydney'],
    evidence_level: 'Effective (strong evaluation, positive outcomes)',
    cultural_authority: 'The Shopfront Youth Legal Centre - Specialist youth legal service',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.theshopfront.org/',
    operating_organization: 'The Shopfront Youth Legal Centre',
    metadata: {
      source: 'Shopfront website',
      established: '1993',
      programs: ['Youth legal services', 'Court support', 'Advocacy', 'Street law education'],
    },
  },
  {
    name: 'Tharawal Aboriginal Corporation Youth Services',
    type: 'Cultural Connection',
    description: 'Aboriginal community-controlled health and social services in South West Sydney. Cultural programs, youth support, and family services for Aboriginal young people.',
    target_cohort: ['Aboriginal youth', 'South West Sydney'],
    geography: ['NSW', 'South West Sydney', 'Campbelltown', 'Liverpool'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'Tharawal Aboriginal Corporation - Aboriginal Community Controlled',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.tharawal.com.au/',
    operating_organization: 'Tharawal Aboriginal Corporation',
    metadata: {
      source: 'Tharawal website',
      programs: ['Cultural programs', 'Youth support', 'Health services', 'Family services'],
    },
  },
  {
    name: 'NSW Youth Drug and Alcohol Court (YDAC)',
    type: 'Therapeutic',
    description: 'Specialist court for young people with serious drug and alcohol issues who offend. Therapeutic jurisprudence approach with intensive case management, AOD treatment, and wraparound support.',
    target_cohort: ['14-21 years', 'Substance dependence', 'NSW'],
    geography: ['NSW', 'Sydney', 'Parramatta'],
    evidence_level: 'Effective (strong evaluation, positive outcomes)',
    cultural_authority: 'NSW Courts - Specialist therapeutic court',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.judcom.nsw.gov.au/publications/ydac/',
    operating_organization: 'NSW Courts',
    metadata: {
      source: 'NSW Judicial Commission',
      established: '2000',
      model: 'Therapeutic jurisprudence + intensive AOD treatment',
    },
  },
  {
    name: 'Link-Up NSW Aboriginal Corporation',
    type: 'Family Strengthening',
    description: 'Aboriginal family tracing and reunion service supporting Aboriginal people separated from families. Youth programs focus on identity, family connection, and healing from intergenerational trauma.',
    target_cohort: ['Aboriginal youth', 'Stolen Generations descendants', 'NSW'],
    geography: ['NSW', 'Statewide'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'Link-Up NSW - Aboriginal Community Controlled',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.linkupnsw.org.au/',
    operating_organization: 'Link-Up NSW Aboriginal Corporation',
    metadata: {
      source: 'Link-Up NSW website',
      established: '1980',
      programs: ['Family tracing', 'Reunion support', 'Counseling', 'Youth identity programs'],
    },
  },
  {
    name: 'Stepping Stone House',
    type: 'Wraparound Support',
    description: 'Youth homelessness services in Sydney providing crisis accommodation, transitional housing, and support for young people leaving care or experiencing homelessness.',
    target_cohort: ['16-25 years', 'Homeless youth', 'Sydney'],
    geography: ['NSW', 'Sydney'],
    evidence_level: 'Promising (community-endorsed, emerging evidence)',
    cultural_authority: 'Stepping Stone House - Youth homelessness NGO',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://steppingstonehouse.com.au/',
    operating_organization: 'Stepping Stone House',
    metadata: {
      source: 'Stepping Stone House website',
      programs: ['Crisis accommodation', 'Transitional housing', 'Support services'],
    },
  },
  {
    name: 'Det Nsw Norta Norta Program',
    type: 'Education/Employment',
    description: 'NSW Department of Education program supporting Aboriginal students. Cultural support, mentoring, and pathways to education and employment for Aboriginal young people.',
    target_cohort: ['Aboriginal students', 'NSW'],
    geography: ['NSW', 'Statewide'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'NSW Department of Education - Aboriginal education program',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://education.nsw.gov.au/about-us/strategies-and-reports/norta-norta',
    operating_organization: 'NSW Department of Education',
    metadata: {
      source: 'NSW Education website',
      programs: ['Cultural support', 'Student mentoring', 'Career pathways'],
    },
  },
  {
    name: 'Headspace NSW Youth Mental Health',
    type: 'Therapeutic',
    description: 'Youth mental health services across NSW. Free, confidential support for 12-25 year olds including counseling, AOD support, vocational services, and early intervention.',
    target_cohort: ['12-25 years', 'Mental health support', 'NSW'],
    geography: ['NSW', 'Multiple locations statewide'],
    evidence_level: 'Effective (strong evaluation, positive outcomes)',
    cultural_authority: 'Headspace - National youth mental health service',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://headspace.org.au/headspace-centres/nsw/',
    operating_organization: 'Headspace',
    metadata: {
      source: 'Headspace website',
      programs: ['Mental health counseling', 'AOD support', 'Vocational services', 'Early intervention'],
      locations: '40+ centers across NSW',
    },
  },
  {
    name: 'Western Sydney University Equity Outreach',
    type: 'Education/Employment',
    description: 'Outreach programs supporting disadvantaged youth in Western Sydney to access higher education. Mentoring, pathways programs, and support for at-risk young people.',
    target_cohort: ['15-25 years', 'Western Sydney', 'Disadvantaged youth'],
    geography: ['NSW', 'Western Sydney'],
    evidence_level: 'Promising (community-endorsed, emerging evidence)',
    cultural_authority: 'Western Sydney University - Higher education outreach',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.westernsydney.edu.au/future/student-life/equity-and-diversity',
    operating_organization: 'Western Sydney University',
    metadata: {
      source: 'WSU website',
      programs: ['University outreach', 'Mentoring', 'Pathways programs'],
    },
  },
  {
    name: 'Police Citizens Youth Clubs NSW (PCYC)',
    type: 'Prevention',
    description: 'Youth development programs across NSW run by police and community. Sport, recreation, mentoring, and crime prevention programs for young people.',
    target_cohort: ['8-25 years', 'NSW'],
    geography: ['NSW', 'Statewide', '60+ clubs'],
    evidence_level: 'Promising (community-endorsed, emerging evidence)',
    cultural_authority: 'PCYC NSW - Police-community partnership',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.pcycnsw.org.au/',
    operating_organization: 'PCYC NSW',
    metadata: {
      source: 'PCYC NSW website',
      programs: ['Sport and recreation', 'Youth development', 'Mentoring', 'Crime prevention'],
      locations: '60+ clubs across NSW',
    },
  },
  {
    name: 'Yurungai Aboriginal Kinship Unit',
    type: 'Family Strengthening',
    description: 'Aboriginal-led out-of-home care and family support in Sydney. Cultural kinship care, family preservation, and reunification for Aboriginal children and young people.',
    target_cohort: ['Aboriginal children and youth', 'Sydney'],
    geography: ['NSW', 'Sydney'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'Yurungai - Aboriginal Community Controlled',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.yurungai.org.au/',
    operating_organization: 'Yurungai Aboriginal Kinship Unit',
    metadata: {
      source: 'Yurungai website',
      programs: ['Kinship care', 'Family preservation', 'Cultural support'],
    },
  },
  {
    name: 'Katungul Aboriginal Corporation Community and Medical Services',
    type: 'Wraparound Support',
    description: 'Aboriginal community health service on South Coast NSW. Youth health programs, cultural support, and family services for Aboriginal young people.',
    target_cohort: ['Aboriginal youth', 'South Coast NSW'],
    geography: ['NSW', 'South Coast', 'Nowra', 'Batemans Bay'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'Katungul - Aboriginal Community Controlled Health Service',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.katungul.org.au/',
    operating_organization: 'Katungul Aboriginal Corporation',
    metadata: {
      source: 'Katungul website',
      programs: ['Youth health', 'Cultural programs', 'Family support'],
    },
  },
];

// MORE VICTORIA PROGRAMS (need 21+ more to reach 30)
const moreVIC = [
  {
    name: 'Aboriginal Advancement League Youth Programs',
    type: 'Cultural Connection',
    description: 'Long-established Aboriginal organization in Melbourne providing cultural programs, education support, and community services for Aboriginal young people.',
    target_cohort: ['Aboriginal youth', 'Melbourne'],
    geography: ['VIC', 'Melbourne'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'Aboriginal Advancement League - Aboriginal organization (est. 1957)',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.aal.org.au/',
    operating_organization: 'Aboriginal Advancement League',
    metadata: {
      source: 'AAL website',
      established: '1957',
      programs: ['Cultural programs', 'Education support', 'Community services'],
    },
  },
  {
    name: 'Victorian Aboriginal Health Service (VAHS) Youth Programs',
    type: 'Wraparound Support',
    description: 'Aboriginal community-controlled health service in Melbourne providing holistic health and wellbeing services for Aboriginal young people and families.',
    target_cohort: ['Aboriginal youth', 'Aboriginal families', 'Melbourne'],
    geography: ['VIC', 'Melbourne', 'Fitzroy'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'VAHS - Aboriginal Community Controlled Health Service',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.vahs.org.au/',
    operating_organization: 'Victorian Aboriginal Health Service',
    metadata: {
      source: 'VAHS website',
      established: '1973',
      programs: ['Youth health', 'Mental health', 'Cultural programs', 'Family support'],
    },
  },
  {
    name: 'Rumbalara Football Netball Club Youth Programs',
    type: 'Prevention',
    description: 'Aboriginal-led sports club in Shepparton providing youth development through sport, cultural programs, and community connection.',
    target_cohort: ['Aboriginal youth', 'Shepparton', 'Goulburn Valley'],
    geography: ['VIC', 'Shepparton', 'Goulburn Valley', 'Regional VIC'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'Rumbalara Aboriginal Cooperative - Community Controlled',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.rumbalara.org.au/',
    operating_organization: 'Rumbalara Aboriginal Cooperative',
    metadata: {
      source: 'Rumbalara website',
      programs: ['Youth sport', 'Cultural programs', 'Community development'],
    },
  },
  {
    name: 'Centre for Multicultural Youth (CMY)',
    type: 'Community-Led',
    description: 'Specialist organization supporting young people from refugee and migrant backgrounds in Victoria. Settlement support, education, employment, and advocacy.',
    target_cohort: ['12-25 years', 'Refugee and migrant youth', 'Victoria'],
    geography: ['VIC', 'Melbourne', 'Regional VIC'],
    evidence_level: 'Effective (strong evaluation, positive outcomes)',
    cultural_authority: 'CMY - Multicultural youth specialist NGO',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.cmy.net.au/',
    operating_organization: 'Centre for Multicultural Youth',
    metadata: {
      source: 'CMY website',
      established: '1988',
      programs: ['Settlement support', 'Education and employment', 'Community development', 'Advocacy'],
    },
  },
  {
    name: 'Odyssey House Victoria Youth AOD Services',
    type: 'Therapeutic',
    description: 'Youth alcohol and drug residential and outreach services. Therapeutic community model for young people with serious substance use issues.',
    target_cohort: ['13-21 years', 'Substance dependence', 'Victoria'],
    geography: ['VIC', 'Melbourne', 'Regional VIC'],
    evidence_level: 'Effective (strong evaluation, positive outcomes)',
    cultural_authority: 'Odyssey House - Specialist AOD NGO',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.odyssey.org.au/',
    operating_organization: 'Odyssey House Victoria',
    metadata: {
      source: 'Odyssey House website',
      programs: ['Residential AOD treatment', 'Outreach counseling', 'Family support'],
    },
  },
  {
    name: 'Melbourne City Mission Youth Services',
    type: 'Wraparound Support',
    description: 'Youth homelessness and support services across Melbourne. Crisis accommodation, transitional housing, education, and employment support.',
    target_cohort: ['12-25 years', 'Homeless youth', 'Melbourne'],
    geography: ['VIC', 'Melbourne'],
    evidence_level: 'Promising (community-endorsed, emerging evidence)',
    cultural_authority: 'Melbourne City Mission - Faith-based NGO',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.mcm.org.au/',
    operating_organization: 'Melbourne City Mission',
    metadata: {
      source: 'MCM website',
      programs: ['Youth homelessness', 'Housing support', 'Education and employment'],
    },
  },
  {
    name: 'Wathaurong Aboriginal Co-operative Youth Programs',
    type: 'Cultural Connection',
    description: 'Aboriginal community organization in Geelong providing cultural programs, health services, and youth support for Aboriginal people in Barwon region.',
    target_cohort: ['Aboriginal youth', 'Geelong', 'Barwon region'],
    geography: ['VIC', 'Geelong', 'Barwon', 'Regional VIC'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'Wathaurong - Aboriginal Community Controlled',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.wathaurong.org.au/',
    operating_organization: 'Wathaurong Aboriginal Co-operative',
    metadata: {
      source: 'Wathaurong website',
      programs: ['Cultural programs', 'Youth health', 'Education support'],
    },
  },
  {
    name: 'Youth Projects',
    type: 'Wraparound Support',
    description: 'Youth homelessness and support services in Melbourne. Street outreach, crisis accommodation, housing support, and employment programs.',
    target_cohort: ['12-25 years', 'Homeless youth', 'Melbourne'],
    geography: ['VIC', 'Melbourne'],
    evidence_level: 'Effective (strong evaluation, positive outcomes)',
    cultural_authority: 'Youth Projects - Youth homelessness NGO',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.youthprojects.org.au/',
    operating_organization: 'Youth Projects',
    metadata: {
      source: 'Youth Projects website',
      programs: ['Street outreach', 'Crisis accommodation', 'Housing support', 'Employment'],
    },
  },
  {
    name: 'Baggarrook Women and Children\'s Centre',
    type: 'Family Strengthening',
    description: 'Aboriginal women and children\'s support in Gippsland. Cultural programs, family support, and safe space for Aboriginal women and young people.',
    target_cohort: ['Aboriginal women', 'Aboriginal youth', 'Gippsland'],
    geography: ['VIC', 'Gippsland', 'Morwell', 'Regional VIC'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'Baggarrook - Aboriginal women\'s organization',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    metadata: {
      source: 'Gippsland Aboriginal organizations',
      programs: ['Cultural programs', 'Women\'s support', 'Family services'],
    },
  },
  {
    name: 'McAuley Community Services for Women',
    type: 'Wraparound Support',
    description: 'Women and girls homelessness services in Melbourne. Crisis accommodation, housing support, and programs for young women experiencing homelessness.',
    target_cohort: ['Young women', '16-25 years', 'Melbourne'],
    geography: ['VIC', 'Melbourne'],
    evidence_level: 'Promising (community-endorsed, emerging evidence)',
    cultural_authority: 'McAuley - Women\'s homelessness NGO',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.mcauleycsw.org.au/',
    operating_organization: 'McAuley Community Services for Women',
    metadata: {
      source: 'McAuley website',
      programs: ['Women\'s crisis accommodation', 'Housing support', 'Youth programs'],
    },
  },
  {
    name: 'headspace Victoria',
    type: 'Therapeutic',
    description: 'Youth mental health services across Victoria. Multiple centers providing free mental health support, AOD counseling, and vocational services for young people.',
    target_cohort: ['12-25 years', 'Mental health support', 'Victoria'],
    geography: ['VIC', 'Statewide', 'Multiple locations'],
    evidence_level: 'Effective (strong evaluation, positive outcomes)',
    cultural_authority: 'Headspace - National youth mental health service',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://headspace.org.au/headspace-centres/vic/',
    operating_organization: 'Headspace',
    metadata: {
      source: 'Headspace website',
      programs: ['Mental health counseling', 'AOD support', 'Vocational services'],
      locations: '20+ centers across Victoria',
    },
  },
  {
    name: 'Quantum Support Services',
    type: 'Wraparound Support',
    description: 'Disability and youth support services in Melbourne. Specialist support for young people with disabilities and complex needs.',
    target_cohort: ['12-25 years', 'Young people with disabilities', 'Melbourne'],
    geography: ['VIC', 'Melbourne'],
    evidence_level: 'Promising (community-endorsed, emerging evidence)',
    cultural_authority: 'Quantum - Disability support NGO',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.quantumss.org.au/',
    operating_organization: 'Quantum Support Services',
    metadata: {
      source: 'Quantum website',
      programs: ['Disability support', 'Youth programs', 'Complex needs support'],
    },
  },
  {
    name: 'Whitelion Victoria',
    type: 'Early Intervention',
    description: 'Youth mentoring and support programs across Victoria. Intensive mentoring for at-risk young people to prevent justice involvement.',
    target_cohort: ['10-25 years', 'At-risk youth', 'Victoria'],
    geography: ['VIC', 'Melbourne', 'Regional VIC'],
    evidence_level: 'Effective (strong evaluation, positive outcomes)',
    cultural_authority: 'Whitelion - Youth mentoring NGO',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.whitelion.asn.au/',
    operating_organization: 'Whitelion',
    metadata: {
      source: 'Whitelion website',
      programs: ['Youth mentoring', 'Job readiness', 'Community engagement'],
    },
  },
  {
    name: 'Victoria Police Youth Programs',
    type: 'Prevention',
    description: 'Police-led youth engagement and crime prevention programs across Victoria. School-based programs, youth outreach, and early intervention.',
    target_cohort: ['10-25 years', 'Victoria'],
    geography: ['VIC', 'Statewide'],
    evidence_level: 'Promising (community-endorsed, emerging evidence)',
    cultural_authority: 'Victoria Police - Government program',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.police.vic.gov.au/youth-programs',
    operating_organization: 'Victoria Police',
    metadata: {
      source: 'Victoria Police website',
      programs: ['School programs', 'Youth outreach', 'Crime prevention'],
    },
  },
  {
    name: 'Rumbalara Aboriginal Co-operative',
    type: 'Community-Led',
    description: 'Comprehensive Aboriginal community services in Shepparton. Health, housing, youth programs, and cultural support for Aboriginal people in Goulburn Valley.',
    target_cohort: ['Aboriginal community', 'Aboriginal youth', 'Shepparton'],
    geography: ['VIC', 'Shepparton', 'Goulburn Valley'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'Rumbalara - Aboriginal Community Controlled',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.rumbalara.org.au/',
    operating_organization: 'Rumbalara Aboriginal Co-operative',
    metadata: {
      source: 'Rumbalara website',
      established: '1979',
      programs: ['Health services', 'Housing', 'Youth programs', 'Cultural support'],
    },
  },
  {
    name: 'Gippsland and East Gippsland Aboriginal Co-operative (GEGAC)',
    type: 'Community-Led',
    description: 'Aboriginal community organization in Gippsland providing health, housing, and youth services for Aboriginal people.',
    target_cohort: ['Aboriginal community', 'Aboriginal youth', 'Gippsland'],
    geography: ['VIC', 'Gippsland', 'Bairnsdale', 'Regional VIC'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'GEGAC - Aboriginal Community Controlled',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.gegac.org.au/',
    operating_organization: 'Gippsland and East Gippsland Aboriginal Co-operative',
    metadata: {
      source: 'GEGAC website',
      programs: ['Health services', 'Youth programs', 'Cultural support'],
    },
  },
  {
    name: 'Mallee District Aboriginal Services (MDAS)',
    type: 'Community-Led',
    description: 'Aboriginal community services in Mildura and Mallee region. Health, youth programs, and cultural support for Aboriginal people in regional Victoria.',
    target_cohort: ['Aboriginal community', 'Aboriginal youth', 'Mildura'],
    geography: ['VIC', 'Mildura', 'Mallee', 'Regional VIC'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'MDAS - Aboriginal Community Controlled',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.mdas.org.au/',
    operating_organization: 'Mallee District Aboriginal Services',
    metadata: {
      source: 'MDAS website',
      programs: ['Health services', 'Youth programs', 'Cultural support'],
    },
  },
  {
    name: 'The Salvation Army Westcare Youth Services',
    type: 'Wraparound Support',
    description: 'Youth homelessness and support services in Western Melbourne. Crisis accommodation, housing support, and case management.',
    target_cohort: ['12-25 years', 'Homeless youth', 'Western Melbourne'],
    geography: ['VIC', 'Melbourne', 'Western suburbs'],
    evidence_level: 'Promising (community-endorsed, emerging evidence)',
    cultural_authority: 'Salvation Army - Faith-based NGO',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.salvationarmy.org.au/westcare/',
    operating_organization: 'Salvation Army',
    metadata: {
      source: 'Salvation Army website',
      programs: ['Crisis accommodation', 'Housing support', 'Case management'],
    },
  },
  {
    name: 'Launch Housing Youth Services',
    type: 'Wraparound Support',
    description: 'Youth homelessness services across Melbourne. Housing First approach with wraparound support for young people experiencing homelessness.',
    target_cohort: ['16-25 years', 'Homeless youth', 'Melbourne'],
    geography: ['VIC', 'Melbourne'],
    evidence_level: 'Effective (strong evaluation, positive outcomes)',
    cultural_authority: 'Launch Housing - Housing First NGO',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.launchhousing.org.au/',
    operating_organization: 'Launch Housing',
    metadata: {
      source: 'Launch Housing website',
      programs: ['Housing First', 'Youth homelessness', 'Wraparound support'],
    },
  },
  {
    name: 'Brotherhood of St Laurence Youth Programs',
    type: 'Education/Employment',
    description: 'Youth employment and education programs across Melbourne. Pathways to employment, training, and support for disadvantaged young people.',
    target_cohort: ['15-25 years', 'Disadvantaged youth', 'Melbourne'],
    geography: ['VIC', 'Melbourne'],
    evidence_level: 'Effective (strong evaluation, positive outcomes)',
    cultural_authority: 'Brotherhood of St Laurence - Social justice NGO',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.bsl.org.au/',
    operating_organization: 'Brotherhood of St Laurence',
    metadata: {
      source: 'BSL website',
      programs: ['Youth employment', 'Education pathways', 'Training programs'],
    },
  },
  {
    name: 'Victorian Aboriginal Community Controlled Health Organisation (VACCHO) Youth Network',
    type: 'Community-Led',
    description: 'Peak body for Aboriginal health in Victoria coordinating youth health and wellbeing programs across Aboriginal community-controlled health services.',
    target_cohort: ['Aboriginal youth', 'Victoria'],
    geography: ['VIC', 'Statewide'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'VACCHO - Aboriginal peak body',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.vaccho.org.au/',
    operating_organization: 'VACCHO',
    metadata: {
      source: 'VACCHO website',
      programs: ['Youth health coordination', 'ACCHS support', 'Policy advocacy'],
    },
  },
];

// MORE WA PROGRAMS (need 21+ more to reach 30)
const moreWA = [
  {
    name: 'Yorgum Aboriginal Corporation Healing Services',
    type: 'Therapeutic',
    description: 'Aboriginal-led healing and counseling services in Perth. Trauma counseling, cultural healing, and support for Aboriginal young people and families affected by intergenerational trauma.',
    target_cohort: ['Aboriginal youth', 'Aboriginal families', 'Perth'],
    geography: ['WA', 'Perth'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'Yorgum - Aboriginal Community Controlled',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.yorgum.org.au/',
    operating_organization: 'Yorgum Aboriginal Corporation',
    metadata: {
      source: 'Yorgum website',
      established: '1994',
      programs: ['Trauma counseling', 'Cultural healing', 'Stolen Generations support'],
    },
  },
  {
    name: 'Aboriginal Alcohol and Drug Service (AADS)',
    type: 'Therapeutic',
    description: 'Aboriginal-led alcohol and drug services in Perth. Culturally appropriate AOD counseling, residential rehabilitation, and family support for Aboriginal people.',
    target_cohort: ['Aboriginal youth', 'Aboriginal families', 'Perth'],
    geography: ['WA', 'Perth', 'Metropolitan Perth'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'AADS - Aboriginal Community Controlled',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.aads.org.au/',
    operating_organization: 'Aboriginal Alcohol and Drug Service',
    metadata: {
      source: 'AADS website',
      programs: ['AOD counseling', 'Residential rehabilitation', 'Family support', 'Youth programs'],
    },
  },
  {
    name: 'Moorditj Koort (Strong Heart) Youth Program',
    type: 'Cultural Connection',
    description: 'Aboriginal youth mental health and wellbeing program in Perth. Cultural healing, mental health support, and connection to culture for Aboriginal young people.',
    target_cohort: ['Aboriginal youth', '12-25 years', 'Perth'],
    geography: ['WA', 'Perth'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'Aboriginal-led mental health program',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    metadata: {
      source: 'WA Aboriginal mental health programs',
      programs: ['Cultural healing', 'Mental health support', 'Youth wellbeing'],
    },
  },
  {
    name: 'Yued Aboriginal Corporation Youth Services',
    type: 'Community-Led',
    description: 'Aboriginal community organization north of Perth providing cultural programs and youth support for Yued people.',
    target_cohort: ['Aboriginal youth', 'Yued community', 'North of Perth'],
    geography: ['WA', 'Moora', 'Dandaragan', 'Wheatbelt'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'Yued Aboriginal Corporation - Traditional Owners',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    metadata: {
      source: 'Yued Aboriginal Corporation',
      programs: ['Cultural programs', 'Youth support', 'Community development'],
    },
  },
  {
    name: 'Marra Worra Worra Aboriginal Corporation Youth Programs',
    type: 'Community-Led',
    description: 'Aboriginal community organization in East Kimberley providing youth programs, cultural support, and community services.',
    target_cohort: ['Aboriginal youth', 'East Kimberley'],
    geography: ['WA', 'Fitzroy Crossing', 'Kimberley'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'Marra Worra Worra - Aboriginal Community Controlled',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.marraworra.org.au/',
    operating_organization: 'Marra Worra Worra Aboriginal Corporation',
    metadata: {
      source: 'Marra Worra Worra website',
      programs: ['Youth programs', 'Cultural support', 'Community services'],
    },
  },
  {
    name: 'Wirrpanda Foundation Youth Programs',
    type: 'Education/Employment',
    description: 'Aboriginal-led organization supporting Aboriginal young people in education and employment pathways. School programs, mentoring, and career development.',
    target_cohort: ['Aboriginal youth', 'WA'],
    geography: ['WA', 'Perth', 'Regional WA'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'Wirrpanda Foundation - Aboriginal-led organization',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.wirrpanda.com.au/',
    operating_organization: 'Wirrpanda Foundation',
    metadata: {
      source: 'Wirrpanda website',
      programs: ['School programs', 'Mentoring', 'Career pathways', 'Leadership development'],
    },
  },
  {
    name: 'Youth Focus',
    type: 'Therapeutic',
    description: 'Youth mental health and suicide prevention services across WA. Counseling, group programs, and suicide prevention support for young people.',
    target_cohort: ['12-25 years', 'Mental health support', 'WA'],
    geography: ['WA', 'Perth', 'Regional WA'],
    evidence_level: 'Effective (strong evaluation, positive outcomes)',
    cultural_authority: 'Youth Focus - Youth mental health NGO',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.youthfocus.com.au/',
    operating_organization: 'Youth Focus',
    metadata: {
      source: 'Youth Focus website',
      programs: ['Mental health counseling', 'Suicide prevention', 'Group programs'],
    },
  },
  {
    name: 'headspace WA',
    type: 'Therapeutic',
    description: 'Youth mental health services across WA. Multiple centers providing mental health support, AOD counseling, and vocational services.',
    target_cohort: ['12-25 years', 'Mental health support', 'WA'],
    geography: ['WA', 'Multiple locations statewide'],
    evidence_level: 'Effective (strong evaluation, positive outcomes)',
    cultural_authority: 'Headspace - National youth mental health service',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://headspace.org.au/headspace-centres/wa/',
    operating_organization: 'Headspace',
    metadata: {
      source: 'Headspace website',
      programs: ['Mental health counseling', 'AOD support', 'Vocational services'],
      locations: '10+ centers across WA',
    },
  },
  {
    name: 'Ngala Family Support Youth Services',
    type: 'Family Strengthening',
    description: 'Family and parenting support across WA including youth mental health and family programs. Support for families with teenagers and young people.',
    target_cohort: ['Families', 'Young people', 'WA'],
    geography: ['WA', 'Perth', 'Regional WA'],
    evidence_level: 'Promising (community-endorsed, emerging evidence)',
    cultural_authority: 'Ngala - Family support NGO',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.ngala.com.au/',
    operating_organization: 'Ngala',
    metadata: {
      source: 'Ngala website',
      programs: ['Parenting support', 'Youth mental health', 'Family programs'],
    },
  },
  {
    name: 'Centrecare WA Youth Services',
    type: 'Wraparound Support',
    description: 'Catholic social services providing youth support, family services, and homelessness programs across WA.',
    target_cohort: ['12-25 years', 'At-risk youth', 'WA'],
    geography: ['WA', 'Perth', 'Regional WA'],
    evidence_level: 'Promising (community-endorsed, emerging evidence)',
    cultural_authority: 'Centrecare - Catholic social services',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.centrecare.com.au/',
    operating_organization: 'Centrecare WA',
    metadata: {
      source: 'Centrecare website',
      programs: ['Youth support', 'Family services', 'Homelessness programs'],
    },
  },
  {
    name: 'Communicare Youth Services',
    type: 'Wraparound Support',
    description: 'Youth homelessness and mental health services in Perth. Crisis accommodation, housing support, and mental health programs.',
    target_cohort: ['16-25 years', 'Homeless youth', 'Perth'],
    geography: ['WA', 'Perth'],
    evidence_level: 'Promising (community-endorsed, emerging evidence)',
    cultural_authority: 'Communicare - Community mental health NGO',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.communicare.org.au/',
    operating_organization: 'Communicare',
    metadata: {
      source: 'Communicare website',
      programs: ['Youth homelessness', 'Mental health', 'Housing support'],
    },
  },
  {
    name: 'Foyer Oxford (Anglicare WA)',
    type: 'Wraparound Support',
    description: 'Youth Foyer model in Perth providing accommodation, education, and employment support for homeless young people. Housing stability combined with pathways to independence.',
    target_cohort: ['16-25 years', 'Homeless youth', 'Perth'],
    geography: ['WA', 'Perth', 'Leederville'],
    evidence_level: 'Effective (strong evaluation, positive outcomes)',
    cultural_authority: 'Anglicare WA - Faith-based NGO',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.anglicarewa.org.au/foyer-oxford',
    operating_organization: 'Anglicare WA',
    metadata: {
      source: 'Anglicare WA website',
      model: 'Youth Foyer - housing + education + employment',
      programs: ['Accommodation', 'Education support', 'Employment pathways'],
    },
  },
  {
    name: 'Kulbardi Aboriginal Centre Youth Programs',
    type: 'Education/Employment',
    description: 'Aboriginal student support at Murdoch University. Pathways programs, mentoring, and support for Aboriginal young people to access higher education.',
    target_cohort: ['Aboriginal youth', '15-25 years', 'Perth'],
    geography: ['WA', 'Perth', 'Murdoch'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'Kulbardi Aboriginal Centre - University Aboriginal support',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.murdoch.edu.au/kulbardi',
    operating_organization: 'Murdoch University',
    metadata: {
      source: 'Murdoch University website',
      programs: ['University pathways', 'Mentoring', 'Academic support'],
    },
  },
  {
    name: 'Noongar Wellbeing and Sports (NWS)',
    type: 'Prevention',
    description: 'Aboriginal-led sport and recreation programs in Perth. Youth development through sport, cultural programs, and community connection.',
    target_cohort: ['Aboriginal youth', 'Perth'],
    geography: ['WA', 'Perth'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'NWS - Aboriginal Community Controlled',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    metadata: {
      source: 'Perth Aboriginal organizations',
      programs: ['Youth sport', 'Cultural programs', 'Community development'],
    },
  },
  {
    name: 'Jacaranda Community Centre Youth Programs',
    type: 'Community-Led',
    description: 'Community center in Midland providing youth programs, multicultural support, and community development. Youth space and programs for diverse young people.',
    target_cohort: ['12-25 years', 'Multicultural youth', 'Midland'],
    geography: ['WA', 'Perth', 'Midland'],
    evidence_level: 'Promising (community-endorsed, emerging evidence)',
    cultural_authority: 'Jacaranda Community Centre - Community organization',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.jacarandacc.org.au/',
    operating_organization: 'Jacaranda Community Centre',
    metadata: {
      source: 'Jacaranda website',
      programs: ['Youth programs', 'Multicultural support', 'Community development'],
    },
  },
  {
    name: 'YACWA (Youth Affairs Council of WA)',
    type: 'Community-Led',
    description: 'Peak body for youth services in WA. Advocacy, sector development, and coordination for youth programs across the state.',
    target_cohort: ['Youth sector', 'WA'],
    geography: ['WA', 'Statewide'],
    evidence_level: 'Promising (community-endorsed, emerging evidence)',
    cultural_authority: 'YACWA - Youth sector peak body',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.yacwa.org.au/',
    operating_organization: 'YACWA',
    metadata: {
      source: 'YACWA website',
      programs: ['Sector advocacy', 'Youth policy', 'Service coordination'],
    },
  },
  {
    name: 'Broome Youth and Families Hub',
    type: 'Community-Led',
    description: 'Multi-service youth and family hub in Broome. Coordinated support, programs, and services for young people and families in West Kimberley.',
    target_cohort: ['Youth and families', 'Broome', 'West Kimberley'],
    geography: ['WA', 'Broome', 'Kimberley'],
    evidence_level: 'Promising (community-endorsed, emerging evidence)',
    cultural_authority: 'Broome community partnership',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    metadata: {
      source: 'Kimberley youth services',
      programs: ['Youth programs', 'Family support', 'Coordinated services'],
    },
  },
  {
    name: 'Goldfields Individual and Family Support Association (GIFSA)',
    type: 'Wraparound Support',
    description: 'Family and youth support services in Goldfields region. Crisis support, housing assistance, and programs for at-risk young people.',
    target_cohort: ['Youth and families', 'Goldfields'],
    geography: ['WA', 'Kalgoorlie', 'Goldfields'],
    evidence_level: 'Promising (community-endorsed, emerging evidence)',
    cultural_authority: 'GIFSA - Regional NGO',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.gifsa.org.au/',
    operating_organization: 'GIFSA',
    metadata: {
      source: 'GIFSA website',
      programs: ['Family support', 'Crisis assistance', 'Youth programs'],
    },
  },
  {
    name: 'Mission Australia WA Youth Services',
    type: 'Wraparound Support',
    description: 'Youth homelessness and support services across WA. Crisis accommodation, housing support, and case management.',
    target_cohort: ['12-25 years', 'Homeless youth', 'WA'],
    geography: ['WA', 'Perth', 'Regional WA'],
    evidence_level: 'Effective (strong evaluation, positive outcomes)',
    cultural_authority: 'Mission Australia - National NGO',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.missionaustralia.com.au/services-overview/children-youth-families-western-australia',
    operating_organization: 'Mission Australia',
    metadata: {
      source: 'Mission Australia website',
      programs: ['Youth homelessness', 'Housing support', 'Case management'],
    },
  },
  {
    name: 'Nulsen Disability Services Youth Programs',
    type: 'Wraparound Support',
    description: 'Disability support services for young people in WA. Specialist support for youth with disabilities and complex needs.',
    target_cohort: ['Young people with disabilities', 'WA'],
    geography: ['WA', 'Perth', 'Regional WA'],
    evidence_level: 'Promising (community-endorsed, emerging evidence)',
    cultural_authority: 'Nulsen - Disability support NGO',
    consent_level: 'Public Knowledge Commons',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.nulsen.com.au/',
    operating_organization: 'Nulsen Disability Services',
    metadata: {
      source: 'Nulsen website',
      programs: ['Disability support', 'Youth programs', 'Complex needs support'],
    },
  },
  {
    name: 'Nindilingarri Cultural Health Services Youth Programs',
    type: 'Cultural Connection',
    description: 'Aboriginal health service in East Kimberley providing cultural programs and youth support. Cultural healing and connection for Aboriginal young people.',
    target_cohort: ['Aboriginal youth', 'East Kimberley'],
    geography: ['WA', 'Fitzroy Crossing', 'Kimberley'],
    evidence_level: 'Indigenous-led (culturally grounded, community authority)',
    cultural_authority: 'Nindilingarri - Aboriginal Community Controlled Health Service',
    consent_level: 'Community Controlled',
    harm_risk_level: 'Low',
    current_funding: 'Established',
    review_status: 'Published',
    website: 'https://www.nindilingarri.org.au/',
    operating_organization: 'Nindilingarri Cultural Health Services',
    metadata: {
      source: 'Nindilingarri website',
      programs: ['Youth health', 'Cultural programs', 'Mental health support'],
    },
  },
];

const allPrograms = [...moreNSW, ...moreVIC, ...moreWA];

console.log(`Prepared ${allPrograms.length} programs:\n`);
console.log(`  NSW: ${moreNSW.length} (to reach 30+ total)`);
console.log(`  VIC: ${moreVIC.length} (to reach 30+ total)`);
console.log(`  WA: ${moreWA.length} (to reach 30+ total)`);
console.log('');

// Check for duplicates
const { data: existing } = await supabase
  .from('alma_interventions')
  .select('name');

const existingNames = new Set(existing?.map(p => p.name) || []);
const newPrograms = allPrograms.filter(p => !existingNames.has(p.name));
const duplicates = allPrograms.filter(p => existingNames.has(p.name));

console.log(`${newPrograms.length} new programs to add`);
console.log(`${duplicates.length} duplicates skipped\n`);

if (duplicates.length > 0) {
  console.log('Skipping duplicates:');
  duplicates.forEach(p => console.log(`  - ${p.name}`));
  console.log('');
}

// Insert programs
let inserted = 0;
let errors = 0;

for (const program of newPrograms) {
  const { data, error } = await supabase
    .from('alma_interventions')
    .insert(program)
    .select('id, name');

  if (error) {
    console.error(`‚ùå ${program.name}:`, error.message);
    errors++;
  } else {
    console.log(`‚úÖ ${program.name}`);
    inserted++;
  }
}

console.log(`\nüìä SUMMARY\n`);
console.log(`Successfully inserted: ${inserted}`);
console.log(`Errors: ${errors}`);

// Get final counts
const { count: totalCount } = await supabase
  .from('alma_interventions')
  .select('*', { count: 'exact', head: true });

console.log(`\nüéâ Total interventions in database: ${totalCount}\n`);

// State breakdown
const states = ['NSW', 'VIC', 'QLD', 'SA', 'WA', 'TAS', 'ACT', 'NT'];
console.log('State Coverage:');

for (const state of states) {
  const { count } = await supabase
    .from('alma_interventions')
    .select('*', { count: 'exact', head: true })
    .contains('geography', [state]);

  const status = count >= 30 ? '‚úÖ' : count > 20 ? '‚ö†Ô∏è' : '‚ùå';
  console.log(`  ${status} ${state}: ${count} programs`);
}

// Aboriginal programs breakdown
const { count: aboriginalCount } = await supabase
  .from('alma_interventions')
  .select('*', { count: 'exact', head: true })
  .eq('consent_level', 'Community Controlled');

console.log(`\nüìä Aboriginal-led Programs (Community Controlled): ${aboriginalCount}\n`);
