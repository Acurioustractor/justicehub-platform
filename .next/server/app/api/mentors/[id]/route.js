"use strict";(()=>{var e={};e.id=9053,e.ids=[9053],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},35900:e=>{e.exports=require("pg")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},63477:e=>{e.exports=require("querystring")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},67264:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>R,patchFetch:()=>q,requestAsyncStorage:()=>f,routeModule:()=>x,serverHooks:()=>h,staticGenerationAsyncStorage:()=>w});var s={};r.r(s),r.d(s,{GET:()=>v,PATCH:()=>g});var i=r(49303),n=r(88716),o=r(60670),a=r(87070),u=r(54674),c=r(89773),l=r(57745),m=r(81445),d=r(75571),p=r(95456);async function v(e,{params:t}){try{let e=t.id,[r]=await u.db.select({id:c.mentors.id,userId:c.mentors.userId,name:c.users.name,email:c.users.email,title:c.mentors.title,bio:c.mentors.bio,longBio:c.mentors.longBio,profileImage:c.mentors.profileImage,organizationId:c.mentors.organizationId,organizationName:c.organizations.name,expertise:c.mentors.expertise,skills:c.mentors.skills,focusAreas:c.mentors.focusAreas,experience:c.mentors.experience,education:c.mentors.education,certifications:c.mentors.certifications,languages:c.mentors.languages,availability:c.mentors.availability,currentMentees:c.mentors.currentMentees,maxMentees:c.mentors.maxMentees,totalMentees:c.mentors.totalMentees,successStories:c.mentors.successStories,rating:c.mentors.averageRating,reviewCount:c.mentors.reviewCount,verified:c.mentors.verified,mentorshipStyle:c.mentors.mentorshipStyle,responseTime:c.mentors.responseTime,acceptanceRate:c.mentors.acceptanceRate,socialLinks:c.mentors.socialLinks,status:c.mentors.status}).from(c.mentors).innerJoin(c.users,(0,l.eq)(c.mentors.userId,c.users.id)).leftJoin(c.organizations,(0,l.eq)(c.mentors.organizationId,c.organizations.id)).where((0,l.eq)(c.mentors.id,e)).limit(1);if(!r)return a.NextResponse.json({error:"Mentor not found"},{status:404});if("active"!==r.status||!r.verified){let e=await (0,d.getServerSession)(p.L);if(!e?.user?.id||e.user.id!==r.userId)return a.NextResponse.json({error:"Mentor not found"},{status:404})}let s=await u.db.select({id:c.mentorReviews.id,rating:c.mentorReviews.rating,title:c.mentorReviews.title,content:c.mentorReviews.content,aspects:c.mentorReviews.aspects,verified:c.mentorReviews.verified,helpful:c.mentorReviews.helpful,createdAt:c.mentorReviews.createdAt,reviewerName:c.users.name}).from(c.mentorReviews).innerJoin(c.users,(0,l.eq)(c.mentorReviews.reviewerId,c.users.id)).where((0,l.eq)(c.mentorReviews.mentorId,e)).orderBy((0,m.C)(c.mentorReviews.createdAt)).limit(10),i={id:r.id,name:r.name,title:r.title||"Mentor",organization:r.organizationName||"Independent",bio:r.bio||"",longBio:r.longBio||"",expertise:r.expertise,skills:r.skills,experience:r.experience||"",education:r.education,certifications:r.certifications,availability:r.availability,mentees:{current:r.currentMentees,total:r.totalMentees,capacity:r.maxMentees},rating:parseFloat(r.rating||"0"),reviews:r.reviewCount,verified:r.verified,languages:r.languages,focusAreas:r.focusAreas,mentorshipStyle:r.mentorshipStyle||"",successStories:r.successStories,responseTime:r.responseTime||"Within 48 hours",acceptanceRate:r.acceptanceRate||0,socialLinks:r.socialLinks,recentReviews:s};return a.NextResponse.json(i)}catch(e){return a.NextResponse.json({error:"Failed to fetch mentor"},{status:500})}}async function g(e,{params:t}){try{let r=await (0,d.getServerSession)(p.L);if(!r?.user?.id)return a.NextResponse.json({error:"Unauthorized"},{status:401});let s=t.id,i=await e.json(),[n]=await u.db.select().from(c.mentors).where((0,l.xD)((0,l.eq)(c.mentors.id,s),(0,l.eq)(c.mentors.userId,r.user.id))).limit(1);if(!n)return a.NextResponse.json({error:"Unauthorized to update this profile"},{status:403});let[o]=await u.db.update(c.mentors).set({...i,updatedAt:new Date}).where((0,l.eq)(c.mentors.id,s)).returning();return a.NextResponse.json({message:"Mentor profile updated successfully",mentor:o})}catch(e){return a.NextResponse.json({error:"Failed to update mentor profile"},{status:500})}}let x=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/mentors/[id]/route",pathname:"/api/mentors/[id]",filename:"route",bundlePath:"app/api/mentors/[id]/route"},resolvedPagePath:"/Users/benknight/Code/JusticeHub/src/app/api/mentors/[id]/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:f,staticGenerationAsyncStorage:w,serverHooks:h}=x,R="/api/mentors/[id]/route";function q(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:w})}},95456:(e,t,r)=>{r.d(t,{L:()=>u});var s=r(54674),i=r(89773),n=r(57745),o=r(75571),a=r.n(o);let u={providers:[(0,r(21474).Z)({clientId:process.env.AUTH0_CLIENT_ID||"",clientSecret:process.env.AUTH0_CLIENT_SECRET||"",issuer:process.env.AUTH0_ISSUER_BASE_URL||""})],session:{strategy:"jwt"},callbacks:{async jwt({token:e,user:t,account:r}){if(r&&t){e.accessToken=r.access_token;let o=t.id,a=await s.db.query.users.findFirst({where:(0,n.eq)(i.users.auth0Id,o)});if(!a){let[e]=await s.db.insert(i.users).values({auth0Id:o,email:t.email,name:t.name,role:"youth"}).returning();a=e}e.id=a.id,e.role=a.role}return e},session:async({session:e,token:t})=>(e.accessToken=t.accessToken,e.user&&(e.user.id=t.id,e.user.role=t.role),e)},secret:process.env.NEXTAUTH_SECRET};a()(u)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[8948,5972,2707,8384,6546,4674],()=>r(67264));module.exports=s})();